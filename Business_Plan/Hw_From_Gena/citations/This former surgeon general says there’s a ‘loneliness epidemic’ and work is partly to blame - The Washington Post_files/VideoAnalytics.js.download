!function(){"use strict";function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s=Array.isArray,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a="object"==typeof e&&e&&e.Object===Object&&e,o="object"==typeof self&&self&&self.Object===Object&&self,r=a||o||Function("return this")(),d=r.Symbol,c=Object.prototype,v=c.hasOwnProperty,p=c.toString,h=d?d.toStringTag:void 0;var w=function(e){var t=v.call(e,h),n=e[h];try{var i=!(e[h]=void 0)}catch(e){}var a=p.call(e);return i&&(t?e[h]=n:delete e[h]),a},f=Object.prototype.toString;var m=function(e){return f.call(e)},y=d?d.toStringTag:void 0;var g=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":y&&y in Object(e)?w(e):m(e)};var b=function(e){return null!=e&&"object"==typeof e};var k=function(e){return"symbol"==typeof e||b(e)&&"[object Symbol]"==g(e)},S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_=/^\w*$/;var T=function(e,t){if(s(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!k(e))||(_.test(e)||!S.test(e)||null!=t&&e in Object(t))};var P=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var A,O=function(e){if(!P(e))return!1;var t=g(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},E=r["__core-js_shared__"],I=(A=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"";var M=function(e){return!!I&&I in e},D=Function.prototype.toString;var C=function(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""},j=/^\[object .+?Constructor\]$/,V=Function.prototype,B=Object.prototype,R=V.toString,L=B.hasOwnProperty,N=RegExp("^"+R.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var W=function(e){return!(!P(e)||M(e))&&(O(e)?N:j).test(C(e))};var x=function(e,t){return null==e?void 0:e[t]};var U=function(e,t){var n=x(e,t);return W(n)?n:void 0},F=U(Object,"create");function H(){this.__data__=F?F(null):{},this.size=0}function $(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var q=Object.prototype.hasOwnProperty;function z(e){var t=this.__data__;if(F){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return q.call(t,e)?t[e]:void 0}var J=Object.prototype.hasOwnProperty;function Z(e){var t=this.__data__;return F?void 0!==t[e]:J.call(t,e)}function G(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=F&&void 0===t?"__lodash_hash_undefined__":t,this}function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Q.prototype.clear=H,Q.prototype.delete=$,Q.prototype.get=z,Q.prototype.has=Z,Q.prototype.set=G;var K=Q;function Y(){this.__data__=[],this.size=0}var X=function(e,t){return e===t||e!=e&&t!=t};var ee=function(e,t){for(var n=e.length;n--;)if(X(e[n][0],t))return n;return-1},te=Array.prototype.splice;function ne(e){var t=this.__data__,n=ee(t,e);return!(n<0)&&(n==t.length-1?t.pop():te.call(t,n,1),--this.size,!0)}function ie(e){var t=this.__data__,n=ee(t,e);return n<0?void 0:t[n][1]}function ae(e){return-1<ee(this.__data__,e)}function oe(e,t){var n=this.__data__,i=ee(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}function re(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}re.prototype.clear=Y,re.prototype.delete=ne,re.prototype.get=ie,re.prototype.has=ae,re.prototype.set=oe;var se=re,ue=U(r,"Map");var de=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var le=function(e,t){var n=e.__data__;return de(t)?n["string"==typeof t?"string":"hash"]:n.map};function ce(e){var t=le(this,e).delete(e);return this.size-=t?1:0,t}function ve(e){return le(this,e).get(e)}function pe(e){return le(this,e).has(e)}function he(e,t){var n=le(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}function we(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}we.prototype.clear=function(){this.size=0,this.__data__={hash:new K,map:new(ue||se),string:new K}},we.prototype.delete=ce,we.prototype.get=ve,we.prototype.has=pe,we.prototype.set=he;var fe=we,me="Expected a function";function ye(a,o){if("function"!=typeof a||null!=o&&"function"!=typeof o)throw new TypeError(me);var r=function(){var e=arguments,t=o?o.apply(this,e):e[0],n=r.cache;if(n.has(t))return n.get(t);var i=a.apply(this,e);return r.cache=n.set(t,i)||n,i};return r.cache=new(ye.Cache||fe),r}ye.Cache=fe;var ge=ye;var be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/\\(\\)?/g,Se=function(e){var t=ge(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var a=[];return 46===e.charCodeAt(0)&&a.push(""),e.replace(be,function(e,t,n,i){a.push(n?i.replace(ke,"$1"):t||e)}),a});var _e=function(e,t){for(var n=-1,i=null==e?0:e.length,a=Array(i);++n<i;)a[n]=t(e[n],n,e);return a},Te=1/0,Pe=d?d.prototype:void 0,Ae=Pe?Pe.toString:void 0;var Oe=function e(t){if("string"==typeof t)return t;if(s(t))return _e(t,e)+"";if(k(t))return Ae?Ae.call(t):"";var n=t+"";return"0"==n&&1/t==-Te?"-0":n};var Ee=function(e){return null==e?"":Oe(e)};var Ie=function(e,t){return s(e)?e:T(e,t)?[e]:Se(Ee(e))};var Me=function(e){if("string"==typeof e||k(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var De=function(e,t){for(var n=0,i=(t=Ie(t,e)).length;null!=e&&n<i;)e=e[Me(t[n++])];return n&&n==i?e:void 0};var Ce=function(e,t,n){var i=null==e?void 0:De(e,t);return void 0===i?n:i};function je(e){var t,n,i,a=e||{};return{vpaid:"object"===u(a.vpaid)||a.vpaid,numberOfRedirects:a.adWrapperIds?a.adWrapperIds.length:null,adId:a.adId||null,adQueryId:a.adQueryId||null,creativeId:(t=a,n=t.adWrapperCreativeIds||[],i=t.creativeId||"",n.push(i),n.filter(function(e){return!!e}).join(",")),title:a.title||null,description:a.description||null,mediaUrl:a.mediaUrl,adSystem:a.adSystem||null,adMeta:function(e){var t=Object.assign({},e);"object"===u(t.vpaid)&&(t.vpaid=!!t.vpaid);try{return JSON.stringify(t)}catch(e){return console.debug(e),""}}(a),isPreloadingAd:a.isPreloading,adWrapperSystems:(a.adWrapperSystems||[]).join(",")}}function Ve(e){var t=0<arguments.length&&void 0!==e?e:{};return t&&"string"==typeof t.creativeId?["715998959","138210079292","716945960","138228291976"].includes(t.creativeId):null}var Be=function(){try{var e=U(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Re=function(e,t,n){"__proto__"==t&&Be?Be(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Le=Object.prototype.hasOwnProperty;var Ne=function(e,t,n){var i=e[t];Le.call(e,t)&&X(i,n)&&(void 0!==n||t in e)||Re(e,t,n)},We=/^(?:0|[1-9]\d*)$/;var xe=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&We.test(e))&&-1<e&&e%1==0&&e<t};var Ue=function(e,t,n,i){if(!P(e))return e;for(var a=-1,o=(t=Ie(t,e)).length,r=o-1,s=e;null!=s&&++a<o;){var u=Me(t[a]),d=n;if(a!=r){var l=s[u];void 0===(d=i?i(l,u,s):void 0)&&(d=P(l)?l:xe(t[a+1])?[]:{})}Ne(s,u,d),s=s[u]}return e};var Fe=function(e,t,n){for(var i=-1,a=t.length,o={};++i<a;){var r=t[i],s=De(e,r);n(s,r)&&Ue(o,Ie(r,e),s)}return o};function He(e,t){return null!=e&&t in Object(e)}var $e=function(e){return b(e)&&"[object Arguments]"==g(e)},qe=Object.prototype,ze=qe.hasOwnProperty,Je=qe.propertyIsEnumerable,Ze=$e(function(){return arguments}())?$e:function(e){return b(e)&&ze.call(e,"callee")&&!Je.call(e,"callee")};var Ge=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991};var Qe=function(e,t,n){for(var i=-1,a=(t=Ie(t,e)).length,o=!1;++i<a;){var r=Me(t[i]);if(!(o=null!=e&&n(e,r)))break;e=e[r]}return o||++i!=a?o:!!(a=null==e?0:e.length)&&Ge(a)&&xe(r,a)&&(s(e)||Ze(e))};var Ke=function(e,t){return null!=e&&Qe(e,t,He)};var Ye=function(n,e){return Fe(n,e,function(e,t){return Ke(n,t)})};var Xe=function(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e},et=d?d.isConcatSpreadable:void 0;var tt=function(e){return s(e)||Ze(e)||!!(et&&e&&e[et])};var nt=function e(t,n,i,a,o){var r=-1,s=t.length;for(i=i||tt,o=o||[];++r<s;){var u=t[r];0<n&&i(u)?1<n?e(u,n-1,i,a,o):Xe(o,u):a||(o[o.length]=u)}return o};function it(e){return(null==e?0:e.length)?nt(e,1):[]}var at=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},ot=Math.max;var rt=function(o,r,s){return r=ot(void 0===r?o.length-1:r,0),function(){for(var e=arguments,t=-1,n=ot(e.length-r,0),i=Array(n);++t<n;)i[t]=e[r+t];t=-1;for(var a=Array(r+1);++t<r;)a[t]=e[t];return a[r]=s(i),at(o,this,a)}};var st=function(e){return function(){return e}};var ut=Be?function(e,t){return Be(e,"toString",{configurable:!0,enumerable:!1,value:st(t),writable:!0})}:function(e){return e},dt=Date.now;var lt=function(n){var i=0,a=0;return function(){var e=dt(),t=16-(e-a);if(a=e,0<t){if(800<=++i)return arguments[0]}else i=0;return n.apply(void 0,arguments)}}(ut);var ct=function(e){return lt(rt(e,void 0,it),e+"")}(function(e,t){return null==e?{}:Ye(e,t)});var vt=function(){};function pt(e,t){return{trackerData:ct(e,t)}}function ht(n){return new Promise(function(e,t){return function(e,t,n){var i=1<arguments.length&&void 0!==t?t:vt,a=2<arguments.length&&void 0!==n?n:vt,o=document.querySelector('script[src="'.concat(e,'"]'));if(o&&o.hasAttribute("data-powa-script"))o.hasAttribute("data-load")?i():o.hasAttribute("data-error")?a():(o.addEventListener("load",i),o.addEventListener("error",a));else{o=document.createElement("script");var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(o,r),o.addEventListener("error",function(){o.setAttribute("data-error",!0),a()}),o.addEventListener("load",function(){o.setAttribute("data-load",!0),i()}),o.setAttribute("data-powa-script",!0),o.type="text/javascript",o.async=!0,o.src=e}}(n,e,t)})}function wt(e,t){var n=1<arguments.length&&void 0!==t?t:{},i=n.prop,a=void 0===i?"name":i,o=n.begin,r=void 0===o?0:o;if(!Array.isArray(e)||e.length<=r)return null;var s=e.slice(r).map(function(e){return e[a]}).join(";");return s.includes(";")&&(s+=";"),s}function ft(e){return(0<arguments.length&&void 0!==e?e:[]).join(";")}function mt(e){var t=0<arguments.length&&void 0!==e?e:(new Date).getTime();return 0<window.performance.timing.domContentLoadedEventStart?t-window.performance.timing.domContentLoadedEventStart:null}function yt(){return Ce(window,"wp_pb.pageName")||Ce(window,"Fusion.template")||""}function gt(){return!0===Ce(window,"wp_meta_data.isHomepage")||"homepage"===Ce(window,"Fusion.metas.contentType.value")?"homepage":yt().startsWith("video")?"leaf":(e=yt()).startsWith("article")||e.startsWith("template/article")?"article page":-1<window.location.href.indexOf("/graphics/")||"interactive graphics"===Ce(window,"wp_content_type","")?"graphics":"wpvIframe"===window.pageType||!!/washingtonpost\.com\/(video|posttv)\/c\/embed/.test(window.location.href)||void 0?"iframe":"other";var e}function bt(e){var t=e.powa,n=e.powaId,i=e.powaTrack,a=e.event;i||(t&&!n&&(n=t.getID()),i=Ce(window,"powas[".concat(n,"].powaTrack"),[]));var o=i.filter(function(e){return e.event===a})[0];return o||null}function kt(e,t){var n=e.powa,i=e.powaId,a=e.powaTrack,o=e.event,r=1<arguments.length&&void 0!==t?t:(new Date).getTime(),s=bt({powa:n,powaId:i,powaTrack:a,event:o});return s?r-s.timestamp:null}var St,_t=function(e){return new RegExp(e.replace("?","\\?"))},Tt=(St=function(e){var t=0<arguments.length&&void 0!==e?e:document.location.search,n={};if(t)if(window.URLSearchParams){var i=new URLSearchParams(t),a=!0,o=!1,r=void 0;try{for(var s,u=i[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value;n[d[0]]=d[1]}}catch(e){o=!0,r=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw r}}}else t.replace(/(^\?)/,"").split("&").forEach(function(e){e=e.split("="),n[e[0]]=e[1]});return n}().embedContext,window.wp_meta_data&&!0===window.wp_meta_data.isPWA?"pwa":"pwa"===window.wp_site?"pwa":/^(fbInstant|amp|pwa)$/.test(St)?St.toLowerCase():"");function Pt(){var e,t,n={url:function(){var e=window.location.origin;e=e||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");return"".concat(e).concat(window.location.pathname)}(),urlQueryString:window.location.search,urlHash:window.location.hash,HTTP_REFERER:document.referrer,isSignedIn:(e="wapo_secure_login_id",t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)"),!(!t||!t[2])),isIframe:window.top!==window.self,embedContext:Tt,site:"amp"===Tt&&/freshcontent=1/.test(document.referrer)?"ampfresh":"amp"===Tt?"amphtml":Tt||(window.self===window.top&&-1<document.domain.indexOf("washingtonpost.com")?"www.washingtonpost.com":window.self!==window.top&&"document.domain"==document.domain&&document.domain===window.top.document.domain?"www.washingtonpost.com":void 0),templateName:yt(),powaVersion:Ce(window,"PoWa.VERSION"),powaBuild:Ce(window,"PoWa.BUILD"),pageType:gt(),pageSection:window.wp_section||"",_pageSubSection:window.wp_subsection||""};try{n.page=window.s.pageName,n.channel=window.s.channel,n.type=window.s.prop3}catch(e){}var i=function(){if(window.wp_pb&&window.wp_pb.BrowserInfo){var e=window.wp_pb.BrowserInfo;return{browser:e.browser&&e.browser.toLowerCase(),os:e.OS&&e.OS.toLowerCase(),version:e.version&&e.version.split(".")[0]}}}();return i&&(n.browser=i.browser,n.os=i.os,n.version=i.version),n}function At(e){if(!e)return{};var t,n=e.getElement(),i=e.getID()||"",a=e.getDataset(),o=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"powaBoot.js";return document.querySelector('script[src*="'+e+'"]')}(),r={playerType:function(e){var t="posttv-embed".concat(Tt?"-"+Tt:"");e.playerType?t=e.playerType:!0===e.discovery?t="posttv-embed-playlist":window.wp_meta_data&&!0===window.wp_meta_data.isHomepage?t="posttv-embed-hp":window.self!==window.top?t="posttv-embed-iframe":window.wp_pb&&/video-leaf-page/.test(window.wp_pb.pageName)&&(t="posttv-leaf");return t}(a),streamType:function(e){var t=window.powas[e].powa.getStatus().stream;try{return t.split("/").pop().split(".")[1].split("?")[0]}catch(e){return null}}(n.id),streamDomain:Ot(n.id),cdn:function(e){if(e){if(/akamai/.test(e))return"akamai";if(/posttv\.com|cloudfront.net/.test(e))return"cloudfront"}}(Ot(n.id))||null,ptvenv:function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"powaBoot.js",t=e&&e.src?e.src.toLowerCase():null,n=t?t.split("//")[1].split("/").slice(1):[],a=n.reduce(function(e,t,n){return-1<t.indexOf(i.toLowerCase())?n:e},0);return 0===a?"prod":"js"===n[a-1]?"local":n[a-1]}(o),powaLoadedVia:(t=o,t?t.dataset.loadedBy||t.dataset.loadedVia:null),nthVideoOnPage:a.powaIndex,_isPrerollPlugin:a.prerollOnly,_isAdDisabledOnPlayer:!1===a.ads,articleAutoplay:a.articleAutoplay,isLooping:a.contintuousPlay||a.loop,isPBVariant:i.endsWith("-variant")};r.loadedBy=a.loadedBy||null,r.loadedByReason=a.loadedByReason||null,r.adTimeoutLength=a.adTimeouts.adStart,r.initOnScroll=!0===a.initOnScroll||!0===a.noVideoOnLivebarStart;var s,u={browser:(s=window.PoWaSettings&&window.PoWaSettings.client||{}).browserName,os:s.isAndroid?"android":s.isKindle?"kindle":s.isMac?"mac":s.isLinux?"linux":s.isIOS?"ios":s.isWindows?"windows":s.isChromeOs?"chromeOS":"",version:s.version,isWebView:s.isWebView};r.browser=u.browser,r.os=u.os,r.version=u.version,u.isWebView&&(r.isWebView=u.isWebView);var d=Ce(window,"PoWaSettings.splitTests.mediaTailorTest");return r.mtTest=d?d.in():null,r.mtAttr=a.mediaTailor,r}function Ot(e){var t=window.powas[e].powa.getStatus().stream||"";return t?t.split("/")[2]:null}var Et=Object.prototype.hasOwnProperty;function It(e,t){return null!=e&&Et.call(e,t)}var Mt=function(e,t){return null!=e&&Qe(e,t,It)};function Dt(e){if(!e)return{};var t=e.getID(),n=window.powas[t].powaTrack,i={startReason:function(e){var t=e.find(function(e){return"promoPlay"===e.event||"start"===e.event});if(t){if(1<Ce(t,"data.videoStarts"))return"continuous";if("promoPlay"===t.event)return"manual";if("start"===t.event)return"autoplay"}}(n)},a=n.filter(function(e){return"adRequest"===e.event})[0],o=n.filter(function(e){return"adImpression"===e.event})[0],r=n.filter(function(e){return"adStart"===e.event})[0],s=n.filter(function(e){return"adComplete"===e.event})[0],u=n.filter(function(e){return"adBarSkip"===e.event})[0],d=r||o||a,l=n.filter(function(e){return"adStartTimeout"===e.event})[0],c=n.filter(function(e){return"adError"===e.event})[0];if(d){i._isAdEventAvailable=!0;var v=d.data.adStatus,p=v.adMeta;i._isBlankAd=Ve(p),i._isPreloadAd=v.adPreload,i._isAdTimeout=!!l,i._isAdRequest=!!a,i._isAdStarted=!!r,i._isAdCompleted=!!s,i._isAdBarSkipped=!!u,i._isAdError=!!c}else i._isAdEventAvailable=!1;var h=n.filter(function(e){return"mtSession"===e.event})[0];h?(i.mt=!1===Mt(h,"data.error"),i.mtError=Mt(h,"data.error")):(i.mt=!1,i.mtError=!1);var w=n.filter(function(e){return"mtAvails"===e.event})[0];return w?(i.mtAvails=!0,i.mtCreativeId=Ce(w,"data.avails[0].ads[0].creativeId"),i.mtVastAdId=Ce(w,"data.avails[0].ads[0].vastAdId"),i.mtAdTitle=Ce(w,"data.avails[0].ads[0].adTitle")):i.mtAvails=!1,n.filter(function(e){return"preview2-autoplay"===e.event})[0]&&(i.isPreview2=!0),n.filter(function(e){return"onceplay-autoplay"===e.event})[0]&&(i.isOnceplay=!0),i}function Ct(e){if(!e)return{};var t,n,i,a,o,r,s=(t=e.getDataset(),n=t.uuid,i=t.playlist||"",a="https://www.washingtonpost.com/video/ans/findByUuid/".concat(n),o="https://www.washingtonpost.com/video/ans/findByUuid/".concat(n,"(.*)recommendedPlaylist=1"),r="https://video-api.washpost.arcpublishing.com/api/v1/ans/playlists/findByPlaylist","function"==typeof Ce(window,"PoWaSettings.videoAPIURL")&&(a=window.PoWaSettings.videoAPIURL({uuid:n,type:"video"}),o=window.PoWaSettings.videoAPIURL({uuid:n,type:"recommended"}),r=window.PoWaSettings.videoAPIURL({type:"playlist",playlist:i})),{video:a,playthrough:o,playlist:r}),u=function(e){var t=e.video,n=e.playlist,i=e.playthrough,a=_t(t),o=_t(i),r=_t(n);try{var s=performance.getEntries().filter(function(e){var t=Ce(e,"name","");return a.test(t)||o.test(t)||r.test(t)})||[],u={};return s.forEach(function(e){var t=Ce(e,"name","");o.test(t)?u.playthrough=Math.round(e.duration):a.test(t)?u.video=Math.round(e.duration):r.test(t)?u.playlist=Math.round(e.duration):u.other=Math.round(e.duration)}),u}catch(e){}}(s),d={};return u.playthrough&&(d.videoApiPlaythrough=u.playthrough,d.videoApiPlaythroughUrl=jt(s.playthrough)),u.video&&(d.videoApiVideo=u.video,d.videoApiVideoUrl=jt(s.video)),u.playlist&&(d.videoApiPlaylist=u.playlist,d.videoApiPlaylistUrl=jt(s.playlist)),u.other&&(d.videoApiOther=u.other),d}function jt(e){var t=(0<arguments.length&&void 0!==e?e:"").split("/");return"".concat(t[2],"/").concat(t[3])}function Vt(e){if("object"!==u(e))return{};var t,n,i,a,o,r,s={videoId:e._id||null,videoName:Ce(e,"headlines.basic",null),videoType:"live"===e.video_type?"livestream":"video",videoSource:Ce(e,"source.name",null),videoCMS:Ce(e,"source.system"),videoHost:Ce(e,"credits.host_talent",null),subsection:Ce(e,"additional_properties.subsection",null),secondarySections:Ce(e,"taxonomy.sections",null),durationInSeconds:e.duration?e.duration/1e3:0,editors:function(e){var t=Ce(e,"credits.by",[]).filter(function(e){return e.name});if(0==t.length){var n=Ce(e,"credits.host_talent"),i=Ce(e,"credits.contributors");if(n&&0!==n.length||i&&0!==i.length)t=null;else{var a=Ce(e,"additional_properties.firstPublishedBy.name",""),o=Ce(e,"additional_properties.firstPublishedBy.lastname","");t=a||o?[{name:"".concat(a," ").concat(o)}]:null}}return t}(e),streamName:Ce(e,"additional_properties.streamName",""),contributors:Ce(e,"credits.contributors"),videoCategory:Ce(e,"additional_properties.videoCategory"),provider:Ce(e,"streams[0].provider"),keywords:Ce(e,"taxonomy.seo_keywords",null),tags:Ce(e,"taxonomy.tags",null),canonicalUrl:Ce(e,"canonical_url"),displayDate:(n=Ce(e,"display_date"),i=new Date(n),a=i.getDate().toString(),o=(i.getMonth()+1).toString(),r=i.getFullYear().toString(),1==o.length&&(o="0"+o),1==a.length&&(a="0"+a),r+"-"+o+"-"+a),_dateLastPublished:(t=e.last_updated_date,new Date(t).getTime()),_adAllowed:Bt(e)};return Bt(e)&&(Lt(e)&&(s.missingAdSetUrl=!0),Nt(e)&&(s.missingAdZone=!0),Wt(e)&&(s.invalidAdZone=!0)),s}var Bt=function(e){var t=Ce(e,"additional_properties.playVideoAds"),n=Rt(e);return t&&n},Rt=function(e){var t=function(e){var t=0<arguments.length&&void 0!==e?e:window.self!==window.top?document.referrer:window.location.href;try{if(t=(t=t.split("/")[2]).split(":")[0]){var n=t.split("."),i=n.length,a="co"===n[i-2]?3:2;if(a<=i){for(var o=[];a;)o.push(n[i-a]),a--;t=o.join(".")}}}catch(e){console.debug(e)}return t}();if(/washingtonpost\.com|localhost|thelily\.com|arcpublishing\.com|wpprivate\.com/.test(t))return!0;var n=function(e){var t=0<arguments.length&&void 0!==e?e:window.self!==window.top?document.referrer:window.location.href;try{t=(t=t.split("/")[2]).split(":")[0]}catch(e){console.debug(e)}return t}();return!!/www-washingtonpost-com\.cdn\.ampproject\.org|wpit\.nile\.works/.test(n)||Ce(e,"additional_properties.advertising.allowPrerollOnDomain")},Lt=function(e){return!Ce(e,"additional_properties.advertising.adSetUrls.apps","")},Nt=function(e){return!Ce(e,"additional_properties.advertising.videoAdZone","")},Wt=function(e){var t=Ce(e,"additional_properties.advertising.videoAdZone","");return!1===/wpni.video/.test(t)};function xt(n,e){var i=1<arguments.length&&void 0!==e?e:(new Date).getTime();if(!n)return{};var a={};Object.keys(n).forEach(function(e){var t;a["timeSince".concat((t=e).charAt(0).toUpperCase()+t.slice(1))]=i-n[e]});var t=mt(i);return t&&(a.timeSinceDomContentLoaded=t),a}function Ut(e){return e.map(function(e){return e.name}).join(", ")}function Ft(e,t){return 0<=t.indexOf(e)?t:"".concat(e).concat(t)}function Ht(e){return"object"!==u(e)?{}:{eVar2:e.pageSection?Ft("wp - ",e.pageSection):"",prop2:e._pageSubSection?Ft("wp - ",e._pageSubSection):"",eVar8:e.editors?Ut(e.editors):"",eVar12:e.videoId,eVar13:(n=e,i=n.subsection||"",a=n._dateLastPublished,o=n.videoName,r=new Date(a).toLocaleDateString("en-US"),s=i?i.toLowerCase()+":":"","".concat(s,"video - ").concat(r," - ").concat(o)),eVar17:e.videoType,eVar36:e.hostTalent?Ut(e.hostTalent):"",eVar37:e.contributors?Ut(e.contributors):"",eVar41:e.videoCategory,eVar42:e.videoSource,eVar44:(t=e,"".concat(t.os," ").concat(t.browser," ").concat(t.version)),eVar47:e.subsection,eVar48:function(e){var t,n;t=e._isAdEventAvailable?e._isPreloadAd?"prefetched":"notfetched":"undefined";e._isAdEventAvailable?e._isBlankAd?n="reqblank":e._isAdError?n="error":e._isAdStarted?n="reqshow":e._isAdTimeout&&(n="reqTimeout"):n=!1===e._adAllowed?"noreq":"undefined";return"".concat(t,":").concat(n)}(e),eVar49:e.playerType,eVar50:e.pageType,eVar58:"washingtonpost.com",rolledUpAdStatus:function(e){var t;e._isAdEventAvailable?e._isBlankAd?t="adBlank":e._isAdError?t="adError":e._isAdCompleted?t="adCompleted":e._isAdStarted?t="adStarted":e._isAdTimeout&&(t="adTimeout"):t=!1===e._adAllowed?"adNotAllowed":e._isAdDisabledOnPlayer?"adDisabled":"undefined";return t}(e)};var t,n,i,a,o,r,s}var $t=function(){function e(){l(this,e)}return t(e,null,[{key:"send",value:function(e,t,n,i){var a=3<arguments.length&&void 0!==i?i:{};if(window.newrelic&&"function"==typeof window.newrelic.addPageAction){var o=Object.assign({},n,{evtType:"string"==typeof t?t:t[0]||""});o.hidden=document.hidden,o.visibilityState=document.visibilityState,void 0===n.timeSincePowaRender&&a.powaId&&(n.timeSincePowaRender=kt({powaId:a.powaId,event:"powaRender"})),!0===a.harvest&&(Object.assign(n,Pt()),a.videoJSON&&Object.assign(n,Vt(a.videoJSON))),"event400"===t&&(o=ct(o,["evtType","evtTime","streamName","ytState","browser","version","os","videoId","url","ptvenv","playerType"]));var r=["videoCMS","videoHost","keywords","tags","canonicalUrl","displayDate","editors","secondarySections","contributors"];Object.keys(o).forEach(function(e,t){r.includes(e)&&delete o[e]}),window.newrelic.addPageAction(e,o)}}}]),e}();var qt=function(){function e(){l(this,e)}return t(e,null,[{key:"send",value:function(e,t,n){if(!window.s||"function"!=typeof window.s.sendDataToOmniture)return!1;var i=Object.assign({},n);delete i.pageType,window.s.sendDataToOmniture(e,t,i,{wait:!0})}},{key:"load",value:function(){window.TWP&&window.TWP.Analytics||ht("https://www.washingtonpost.com/wp-stat/analytics/latest/main.js").then(function(){console.log("analytics main.js loaded from videoAnalytics"),window.TWP.Analytics.init({suppressTrackPageLoad:!0})}).catch(function(e){return console.log("could not load main.js".err)})}}]),e}(),zt=["nthVideoOnPage","playerType","templateName","eVar48","timeInterval","cdn","streamType"];var Jt=function(){function e(){l(this,e),this.mpulseEvents={},this.mpulseInterval||this.startMpulseInterval.call(this)}return t(e,[{key:"send",value:function(e,t,n){if(!window.BOOMR||0<n.playCounter)this.debugTracking&&console.debug("No BOOMR on page or playthrough video");else{var i,a={};switch(t){case"event9":i="videoStart";break;case"event7":i="videoAdStart";break;case"event32_1":i="adReqTimeout";break;case"event9999_01":i="videoTimeout";break;case"event125":i="promoClick";break;case"event9999":i="videoError";break;case"event9999_preload":i="videoErrorPreload"}switch(i){case"promoClick":a[i]=n.timeSinceDomContentLoaded||0;break;case"videoStart":a[i]=(n.timeSinceAdEnd?n.timeSinceAdEnd:n.timeSincePromoClick)||0;break;case"videoError":a[i]=n.timeSincePlayerStart||0;break;case"videoErrorPreload":a[i]=n.timeSincePlayerReady||0;break;default:a[i]=n.timeSincePromoClick||0}this.addEvent(n.videoId,a,n)}}}]),t(e,[{key:"startMpulseInterval",value:function(){var a=this;this.mpulseInterval=window.setInterval(function(){Object.keys(a.mpulseEvents).forEach(function(e){a.setDimensionsByUuid(e);var t=a.popEventsForUuid(e);if(window.BOOMR&&window.BOOMR.sendTimers&&window.BOOMR.sendMetrics&&t.length){console.debug("Sending mpulse events",e,t);var n=a.formatTimersToSend(t);window.BOOMR.sendTimers(n);var i=a.formatMetricsToSend(t);window.BOOMR.sendMetrics(i)}})},15e3)}},{key:"createUuid",value:function(e,t){return this.mpulseEvents[e]={},this.mpulseEvents[e].params=t||{},this.mpulseEvents[e].eventsWaiting=[],this.mpulseEvents[e]}},{key:"getByUuid",value:function(e){return this.mpulseEvents[e]?this.mpulseEvents[e]:null}},{key:"addEvent",value:function(e,t,n){var i=this.getByUuid(e);i?i.params=n||{}:i=this.createUuid(e,n),i&&i.eventsWaiting.push(t)}},{key:"formatTimersToSend",value:function(e){return Object.assign.apply(Object,[{}].concat(n(e)))}},{key:"formatMetricsToSend",value:function(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(e){t[e]=1})}),t}},{key:"popEventsForUuid",value:function(e){var t=this.getByUuid(e);if(t&&t.eventsWaiting){var n=t.eventsWaiting;return t.eventsWaiting=[],n}return null}},{key:"setDimensionsByParams",value:function(a){zt.forEach(function(e){var t,n,i=e;switch(e){case"templateName":i="template";break;case"eVar48":i="adState"}window["mpulseVideo_".concat(i)]=a[e]||0==a[e]?(n=a[t=e],"templateName"===t&&-1<n.indexOf("article")?n:"eVar48"===t?n.split(":").pop(1):n):"undefined"})}},{key:"setDimensionsByUuid",value:function(e){var t=this.getByUuid(e);t&&t.params&&this.setDimensionsByParams(t.params)}}]),e}(),Zt=function(){return r.Date.now()},Gt=/^\s+|\s+$/g,Qt=/^[-+]0x[0-9a-f]+$/i,Kt=/^0b[01]+$/i,Yt=/^0o[0-7]+$/i,Xt=parseInt;var en=function(e){if("number"==typeof e)return e;if(k(e))return NaN;if(P(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=P(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Gt,"");var n=Kt.test(e);return n||Yt.test(e)?Xt(e.slice(2),n?2:8):Qt.test(e)?NaN:+e},tn=Math.max,nn=Math.min;var an="https://d1get58iwmjrxx.cloudfront.net/collector",on=["evtType","evtTime","streamName","ytState","browser","version","os","videoId","url","ptvenv","playerType","vendor","visibilityState","rolledUpAdStatus","initOnScroll","nthVideoOnPage","playCounter","videoType","pageType","event501","timeSinceDomContentLoaded","timeSincePowaRender","timeSincePromoClick"];var rn=[];var sn=function(i,a,e){var o,r,s,u,d,l,c=0,v=!1,p=!1,t=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function h(e){var t=o,n=r;return o=r=void 0,c=e,u=i.apply(n,t)}function w(e){var t=e-l;return void 0===l||a<=t||t<0||p&&s<=e-c}function f(){var e,t,n=Zt();if(w(n))return m(n);d=setTimeout(f,(t=a-((e=n)-l),p?nn(t,s-(e-c)):t))}function m(e){return d=void 0,t&&o?h(e):(o=r=void 0,u)}function n(){var e,t=Zt(),n=w(t);if(o=arguments,r=this,l=t,n){if(void 0===d)return c=e=l,d=setTimeout(f,a),v?h(e):u;if(p)return clearTimeout(d),d=setTimeout(f,a),h(l)}return void 0===d&&(d=setTimeout(f,a)),u}return a=en(a)||0,P(e)&&(v=!!e.leading,s=(p="maxWait"in e)?tn(en(e.maxWait)||0,a):s,t="trailing"in e?!!e.trailing:t),n.cancel=function(){void 0!==d&&clearTimeout(d),o=l=r=d=void(c=0)},n.flush=function(){return void 0===d?u:m(Zt())},n}(function(){for(var e=[],t=0;0<rn.length&&t<10;t++){var n=rn.pop(),i=n.name,a=n.data;e.push({name:i,data:a})}var o=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],a="";return e.forEach(function(e){var t=e.name,n=e.data,i={sourcetype:"httpevent",event:{name:t,data:n}};n.evtTime&&(i.time=Math.floor(n.evtTime/1e3)),a+=JSON.stringify(i)}),a}(e);fetch(an,{method:"POST",body:{postBody:o}.postBody}).then(function(e){}).catch(function(e){console.error(e)}),rn.length&&sn()},6e4,{maxWait:6e4}),un=function(){function e(){l(this,e)}return t(e,null,[{key:"send",value:function(e,t,n,i){var a=3<arguments.length&&void 0!==i?i:{};n.timeSinceDomContentLoaded||(n.timeSinceDomContentLoaded=mt()),n.pageType||(n.pageType=gt()),void 0===n.timeSincePowaRender&&a.powaId&&(n.timeSincePowaRender=kt({powaId:a.powaId,event:"powaRender"})),!0===a.harvest&&(Object.assign(n,Pt()),a.videoJSON&&Object.assign(n,Vt(a.videoJSON)));var o,r=Object.assign({evtName:e,evtType:"string"==typeof t?t:t[0]||"",evtTime:Date.now()},ct(n,on));o={name:e,data:r},rn.push(o),sn()}}]),e}();var dn=function(){function e(){l(this,e)}return t(e,null,[{key:"send",value:function(e,t,n,i){var a=3<arguments.length&&void 0!==i?i:{};n.pageType||(n.pageType=gt()),!0===a.harvest&&(Object.assign(n,Pt()),a.videoJSON&&Object.assign(n,Vt(a.videoJSON))),window.dataLayer=window.dataLayer||[];var o,r,s,u,d={event:e,action:e,category:"video",label:(o=n,r=Ce(o,"startReason",null),s=Ce(o,"pageType",null),Ce(o,"isPreview2",null)?"autoplay-"+Ce(cn,s)+"-preroll":r&&s?Ce(ln,r)+"-"+Ce(cn,s):Ce(cn,s))},l={avName:Ce(u=n,"videoName"),avProducer:wt(Ce(u,"editors",null)),avCMS:Ce(u,"videoCMS"),avHost:wt(Ce(u,"videoHost")),avSection:Ce(u,"subsection"),avSecondarySections:wt(Ce(u,"secondarySections",null),{begin:1}),avSource:Ce(u,"videoSource"),avPlayer:Ce(u,"player","powa"),avPlayerType:Ce(u,"playerType"),avLength:Ce(u,"durationInSeconds"),avArcID:Ce(u,"videoId"),avType:Ce(u,"videoCategory"),avContributors:wt(Ce(u,"contributors",null)),avHostID:wt(Ce(u,"videoHost"),{prop:"slug"}),avContributorID:wt(Ce(u,"contributors",null),{prop:"slug"}),avTags:ft(function(e){var t=0<arguments.length&&void 0!==e?e:[],n=[];for(var i in t)n.push(t[i].text);return n}(Ce(u,"tags"),!0)),avDesk:null,avPublishDate:Ce(u,"displayDate"),avKeywords:ft(Ce(u,"keywords")),adAttribute:Ce(u,"rolledUpAdStatus")},c=Object.assign({},d,l),v=Ce(window,"PoWaSettings.splitTests.newCopyTest"),p=Ce(n,"isPreview2",null);v&&p&&(c.avTestGroup="".concat(v.getPrefix(),"_").concat(v.getFacet())),window.dataLayer.push(c)}}]),e}();var ln={continuous:"rollthrough",manual:"click",autoplay:"autoplay"},cn={homepage:"homepage",leaf:"leaf","article page":"embed",graphics:"graphics",other:"embed",iframe:"iframe"};var vn={event125:{name:"video-promo-click",newRelicName:"promo-clicked",newrelic:!0,omniture:!0,mpulse:!0,google:!0,timeMarker:"promoClick",addEventsBasedOnState:!0},event6:{name:"video-social-share",newrelic:!0,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event9:{name:"video-start",newRelicName:"Video Start",newrelic:!0,omniture:!0,mpulse:!0,google:!0,splunk:!0,timeMarker:"videoStart",addEventsBasedOnState:!0},event10:{name:"video-25-complete",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event11:{name:"video-50-complete",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event12:{name:"video-75-complete",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event13:{name:"video-complete",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event34:{name:"ad-video-skip",newrelic:!0,omniture:!0,mpulse:!1,google:!0,timeMarker:"adSkip",addEventsBasedOnState:!0},event73:{name:"video-unmute",newrelic:!0,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event128:{name:"video-mute",newrelic:!0,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event136:{name:"video-pause",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event137:{name:"video-unpause",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event140:{name:"ad-video-pause",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event141:{name:"ad-video-unpause",newrelic:!1,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event143:{name:"ad-video-mute",newrelic:!1,omniture:!0,mpulse:!1,google:!1,addEventsBasedOnState:!0},event144:{name:"ad-video-unmute",newrelic:!1,omniture:!0,mpulse:!1,google:!1,addEventsBasedOnState:!0},event166:{name:"fullscreen-engaged",newrelic:!0,omniture:!0,mpulse:!1,google:!0,addEventsBasedOnState:!0},event167:{name:"video-up-next-dismiss",newrelic:!0,omniture:!0,mpulse:!1,addEventsBasedOnState:!0},event172:{name:"enter-pip",omniture:!0,newrelic:!0},event173:{name:"exit-pip",omniture:!0,newrelic:!0},event75:{name:"video-autoplay",newRelicName:"Autoplay",omniture:!0,newrelic:!0,splunk:!0,google:!0},"sticky-engage":{name:"sticky-engage",newrelic:!0}},pn={event7:{name:"video-ad-start",newRelicName:"Video Ad Start",newrelic:!0,omniture:!0,mpulse:!0,google:!0,splunk:!0,timeMarker:"adStart",addEventsBasedOnState:!0},event7_1:{name:"Video Ad Impression",newrelic:!0},event8:{name:"video-ad-complete",newRelicName:"Video Ad Complete",newrelic:!0,omniture:!0,mpulse:!0,google:!0,timeMarker:"adEnd",addEventsBasedOnState:!0},event9996_3:{name:"APS Timeout",newrelic:"true"},event9996_4:{name:"APS Response"}},hn={event9994:{name:"Setup error",newrelic:!0},event9991_04:{name:"Non-blocking error"}},wn={name:"player-video-ready",newRelicName:"Player Ready",newrelic:!0,google:!0,splunk:!0,timeMarker:"powaRender"},fn=function(){function i(e){var t=this;if(l(this,i),!e.powa||!e.va)throw"Invalid settings to setup event5_2";this.powa=e.powa,this.va=e.va;var n=bt({powa:this.powa,event:"powaRender"});n?this.send(n.timestamp):this.powa.once("powaRender",function(e){t.send()})}return t(i,[{key:"send",value:function(e){var t=0<arguments.length&&void 0!==e?e:(new Date).getTime();this.va.send("event5_2",{config:wn,time:t,trackerData:{timeSinceNavigationStart:function(e){var t=0<arguments.length&&void 0!==e?e:(new Date).getTime();return 0<window.performance.timing.navigationStart?t-window.performance.timing.navigationStart:null}()}})}}]),i}(),mn={name:"YT State",splunk:!0},yn=6e4,gn=function(){function d(e){var t=this;if(l(this,d),!e.powa||!e.va)throw"Invalid settings to setup event400";this.powa=e.powa,this.el=this.powa.getElement(),this.va=e.va;var n=this.powa.getDataset(),i=this.powa.getVideoData();if("live-bar"!==n.playerType){var a=!0===Ce(window,"wp_meta_data.isHomepage")||"homepage"===Ce(window,"Fusion.metas.contentType.value"),o=Ce(window,"wpMetaData.subType")||Ce(window,"Fusion.globalContent.subtype",""),r="live-all"===o||"highlights"===o,s="live"===i.video_type;if(n.event400||(a||r)&&s){0<Ce(i,"taxonomy.tags",[]).filter(function(e){return"flex-event"===e.text}).length&&(mn.newrelic=!0);var u=Ce(i,"additional_properties.publicationEndDate");u&&(this.endDate=new Date(u)),this.interval=yn,this.powa.on("previewClicked",function(){return t.onInteraction()}),this.powa.on("promoPlay",function(){return t.onInteraction()}),this.powa.on("time",function(){return t.onTime()})}}}return t(d,[{key:"onInteraction",value:function(){this.interacted=!0}},{key:"onTime",value:function(){var t=this;!this.pingInterval&&this.interacted&&(this.send(),this.pingInterval=window.setInterval(function(){t.send(),t.powa.getDataset().livePingEnded&&window.clearInterval(t.pingInterval);var e=new Date;t.endDate&&e>t.endDate&&window.clearInterval(t.pingInterval)},this.interval))}},{key:"send",value:function(){this.va.send("event400",{config:mn,trackerData:{ytState:this.powa.getStatus().state}})}}]),d}(),bn={event500:{name:"Player Waiting",newrelic:!0},event501:{name:"Player Waiting End",newrelic:!0,splunk:!0,timeMarker:!0},event9999_01:{name:"Video Timeout",newrelic:!0,mpulse:!0,splunk:!0}},kn=2e3,Sn=8,_n=function(){function n(e){var t=this;if(l(this,n),!e.powa||!e.va)throw"Invalid settings to setup event500";this.powa=e.powa,this.va=e.va,this.debug=e.va.debug,this.interval=kn,this.maxRuns=Sn,this.sentOnPlayback=!1,this.sentOnTimeout=!1,this.powa.on("start",function(e){return t.onStart(e)}),this.powa.on("adStart",function(e){return t.onAdStart(e)}),this.powa.on("firstFrame",function(e){return t.onFirstFrame(e)}),this.powa.on("time",function(e){return t.onTime(e)}),this.powa.on("end",function(e){return t.onEnd(e)}),this.onTimeout=e.onTimeout||function(){}}return t(n,[{key:"onStart",value:function(){var e=this;this.pingInterval&&window.clearInterval(this.pingInterval),this.pingCount=0,this.sentOnPlayback=!1,this.sentOnTimeout=!1,this.pingInterval=window.setInterval(function(){e.pingCount++,e.send("event500"),e.pingCount>=e.maxRuns&&e._onTimeout()},this.interval)}},{key:"onAdStart",value:function(e){this._onPlayback(e)}},{key:"onFirstFrame",value:function(e){this._onPlayback(e)}},{key:"onTime",value:function(e){this._onPlayback(e)}},{key:"onEnd",value:function(){window.clearInterval(this.pingInterval)}},{key:"_onPlayback",value:function(e){this.sentOnPlayback||(window.clearInterval(this.pingInterval),this.send("event501",{event501:"firstPicture",firstPictureReason:Ce(e,"type","")}),this.sentOnPlayback=!0)}},{key:"_onTimeout",value:function(){this.sentOnTimeout||(window.clearInterval(this.pingInterval),this.send("event501",{event501:"timeout"}),this.sentOnTimeout=!0,this.send("event9999_01"))}},{key:"send",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{},i=bn[e];n.pingCount=this.pingCount,!0===i.timeMarker&&(i.timeMarker=n.event501),this.va.send(e,{config:i,trackerData:n})}}]),n}(),Tn={name:"Setup error",newrelic:!0,splunk:!0},Pn=function(){function n(e){var t=this;if(l(this,n),!e.powa||!e.va)throw"Invalid settings to setup event9994";this.powa=e.powa,this.va=e.va,this.powa.on("powaError",function(e){t.send(e)})}return t(n,[{key:"send",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},n=Ce(t,"error.error")||Ce(t,"error.message")||Ce(t,"message");this.va.send("event9994",{config:Tn,trackerData:{errorText:n}})}}]),n}(),An={event9996:{name:"Video Ad Error",newrelic:!0,splunk:!0}},On=function(){function n(e){var t=this;if(l(this,n),!e.powa||!e.va)throw"Invalid settings to setup event9996";this.powa=e.powa,this.va=e.va,this.powa.on("adError",function(e){t.send("event9996",e)})}return t(n,[{key:"send",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{};if(!Ve(n.adMeta)){var i=An[e];this.va.send(e,{config:i,trackerData:{errorText:n.error,prerollAdError:n.error}})}}}]),n}(),En={event9991_04:{name:"Non-blocking error"},event9999:{name:"Video Error",newrelic:!0,mpulse:!0,splunk:!0},event9999_preload:{name:"Video Error before start",newrelic:!0,mpulse:!0},event9999_deluge:{name:"Video Error deluge",newrelic:!0}},In=50,Mn=["details","code","mediaError","fatal","type","stream","time"],Dn=function(){function n(e){if(l(this,n),!e.powa||!e.va)throw"Invalid settings to setup event400";this.powa=e.powa,this.va=e.va;var t=this.powa.getID();this.powaTrack=window.powas[t].powaTrack,this.deluge=In,this.errorCount=0,this.powa.on("start",this.onStart.bind(this)),this.powa.on("error",this.onError.bind(this))}return t(n,[{key:"onStart",value:function(){this.started=!0}},{key:"onError",value:function(e){e.nonBlocking?this.send("event9991_04",e):this.started?(this.errorCount++,this.errorCount>this.deluge?this.send("event9999_deluge",e):this.send("event9999",e)):this.send("event9999_preload",e)}},{key:"send",value:function(e,t){var n,i=ct(1<arguments.length&&void 0!==t?t:{},Mn);try{n=this.powa.getElement().querySelector("video.powa-video").error.message}catch(e){}var a=En[e];this.va.send(e,{config:a,trackerData:{errorText:JSON.stringify(i),errorMessage:n,errorType:i.type,errorDetails:i.type}})}}]),n}(),Cn={"mt-session-error":{name:"MediaTailor Session Error",newrelic:!0},"mt-avails-error":{name:"MediaTailor Avails Error",newrelic:!0}},jn=function(){function a(e){var t=this;if(l(this,a),!e.powa||!e.va)throw"Invalid settings to setup event400";this.powa=e.powa,this.el=this.powa.getElement(),this.va=e.va,this.powa.on("mtSession",function(e){return t.onMtSession(e)}),this.powa.on("mtAvails",function(e){return t.onMtAvails(e)});var n=this.powa.getID(),i=window.powas[n].powaTrack.filter(function(e){return"mtSession"===e.event})[0];i&&this.onMtSession(i.data)}return t(a,[{key:"onMtSession",value:function(e){e.error&&this.send("mt-session-error",e)}},{key:"onMtAvails",value:function(e){e.error&&this.send("mt-avails-error",e)}},{key:"send",value:function(e,t){var n=Cn[e],i=Ce(1<arguments.length&&void 0!==t?t:{},"error.response","").replace(/('{.*}')/g,"'{...}'");this.va.send(e,{config:n,trackerData:{errorText:i}})}}]),a}(),Vn={name:"video-30-second",google:!0},Bn=function(){function n(e){var t=this;if(l(this,n),!e.powa||!e.va)throw"Invalid settings to setup event3030";this.powa=e.powa,this.va=e.va,"live"===this.powa.getVideoData().video_type||(this.sent=!1,this.powa.on("start",function(e){return t.onStart(e)}),this.powa.on("time",function(e){return t.checkThirty(e)}))}return t(n,[{key:"checkThirty",value:function(e){this.sent||e.time&&30<=e.time&&(this.send(),this.sent=!0)}},{key:"onStart",value:function(){this.sent=!1}},{key:"send",value:function(){this.va.send("thirtySecondPlayback",{config:Vn})}}]),n}();var Rn={name:"powa-impression",google:!0},Ln=function(){function o(e){var t=this,n=e.powa,i=e.va;if(l(this,o),!n||!i)throw"Invalid settings to setup event5_3";this.powa=n,this.va=i,this.isSent=!1;var a=this.powa.getDataset();!0===a.autoplay?(this.powa.once("start",function(e){return t.send()}),this.powa.once("powaReady",function(e){"autoplayBlocked"===t.powa.getStatus().autoplayStatus&&t.send("manual")})):!0===a.viewportAutoplay?(this.powa.once("start",function(e){return t.send()}),this.powa.once("ViewportAutoplay-blocked",function(e){return t.send("manual")})):!0===a.preview2?(this.powa.once("preview2-autoplay",function(e){return t.send()}),this.powa.once("preview2-autoplay-blocked",function(e){return t.send("manual")})):this.send("manual")}return t(o,[{key:"send",value:function(e){this.isSent||(this.va.send("event5_3",{config:Rn,trackerData:e?{startReason:e}:{},time:(new Date).getTime()}),this.isSent=!0)}}]),o}(),Nn={allowMpulse:!0},Wn=[0,25,50,75,100],xn=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(l(this,n),!e||!t.data&&!t.powaId)throw"missing required stuff";this.events=Object.assign({},vn,pn,hn),this.data=t.data,this.options=Object.assign({},Nn,t),this.userClickedToPlay=!1,this.debug=window.location.search.includes("vaDebug=true"),this.initTimeIntervals(),this.playCounter=0,this.firstPlay=!0,this.timeMarkers={},this.trackLiveTime=this.trackLiveTime.bind(this),t.powaId&&window.powas&&window.powas[t.powaId]&&(this.powa=window.powas[t.powaId].powa,this.data=this.powa.getVideoData(),this.powaVersionCheck()),function(){try{return window.self!==window.top}catch(e){return!0}}()&&this.loadTrackingScripts(),this.harvest=Object.assign(Pt(),Vt(this.data),At(this.powa),Ct(this.powa)),this.powa&&this.initListeners(),this.options.allowMpulse&&(this.mpulse=new Jt)}return t(n,[{key:"loadTrackingScripts",value:function(){qt.load()}},{key:"registerPoWa",value:function(e){this.powa?console.warn("Calling registerPoWa() but you already have a powa"):(this.powaVersionCheck(),this.powa=window.powas[e].powa,this.data=this.powa.getVideoData(),Object.assign(this.harvest,Vt(this.data),At(this.powa),Ct(this.powa)),this.initListeners())}},{key:"scanPowa",value:function(){this.data=this.powa.getVideoData(),Object.assign(this.harvest,Vt(this.data),At(this.powa))}},{key:"scanPerformance",value:function(){Object.assign(this.harvest,Ct(this.powa))}},{key:"send",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{};if(this.debug&&console.debug("VA send()",e),!e)throw"no event";var i=e.split(",")[0],a=n.config||this.events[i];if(!a)return!1;var o=n.time?xt(this.timeMarkers,n.time):xt(this.timeMarkers),r=Dt(this.powa),s={visibilityState:document.visibilityState,imaVersion:Ce(window,"google.ima.VERSION")},u=function(){return{videoAnalyticsVersion:"1.7.23",playCounter:this.playCounter,vendor:this.powa?"PoWa":void 0,adEndVisibilityState:this.adEndVisibilityState}}.call(this),d=Object.assign({},this.harvest,o,u,r,s,n.trackerData,je(n.adMeta)||{}),l=Ht(d);d=Object.assign({},d,l),a.timeMarker&&(n.time?this.setTimeMarker(a.timeMarker,n.time):this.setTimeMarker(a.timeMarker)),a.addEventsBasedOnState&&this.powa&&(e=function(e,t){var n="",i=this.powa?this.powa.getVideoData():{},a=this.powa&&this.powa.getStatus(),o=a&&a.adStatus&&a.adStatus.adPreload;return"event9"===e&&(n+=",event116="+Math.round(i.duration/1e3),"manual"===t.startReason&&0===this.playCounter&&(n+=",event121"),"inline-player-playlist"===t.playerType&&0<this.playCounter&&(n+=",event118")),o&&0===this.playCounter?n+=",event126":0<this.playCounter&&(n+=",event127"),!0===t.articleAutoplay&&(n+=",event142"),"".concat(e).concat(n)}.call(this,e,d)),Object.keys(d).forEach(function(e,t){e.startsWith("_")&&delete d[e]}),a.omniture&&qt.send(a.name,e,d),a.newrelic&&$t.send(a.newRelicName||a.name,i,d),a.splunk&&un.send(a.name,i,d),a.google&&dn.send(a.name,e,d),a.mpulse&&this.mpulse&&this.mpulse.send(a.name,i,d)}},{key:"sendAdEvent",value:function(e,t){var n,i=1<arguments.length&&void 0!==t?t:{};if(!Ve(i.adMeta)){var a=this.powa.getElement();i=Object.assign(i,{trackerData:{isInViewport:function(e,t,n){var i=1<arguments.length&&void 0!==t?t:1,a=2<arguments.length&&void 0!==n&&n;if(e instanceof HTMLElement){var o=e.getBoundingClientRect();return 0<=o.top+e.offsetHeight*i&&o.bottom-e.offsetHeight*i<=(window.innerHeight||document.documentElement.clientHeight)&&(!a||0<=o.left)&&(!a||o.right<=(window.innerWidth||document.documentElement.clientWidth))}return null}(a),isSticky:(n=a,n&&n.closest?null!==n.closest(".powa-sticky-stick.powa-sticky"):null)}}),this.send(e,i)}}},{key:"initFlags",value:function(){this.userPaused=!1,this.userPausedAd=!1,delete this.adEndVisibilityState}},{key:"initTimeIntervals",value:function(){this.timeIntervals=Wn.slice()}},{key:"setTimeMarker",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:(new Date).getTime();if(!e)throw"name required for time marker";this.debug&&console.debug("VA setTimeMarker()",e),this.timeMarkers[e]=n}},{key:"unsetTimeMarkers",value:function(){this.timeMarkers={}}},{key:"trackLiveTime",value:function(e){"live-bar"!==this.powa.getDataset().playerType&&(!this.userClickedToPlay&&this.powa.getStatus().muted&&!0!==e.fullscreen||(this.send("event9"),this.powa.off("time",this.trackLiveTime)))}},{key:"trackFullscreen",value:function(e){e.fullscreen&&this.send("event166")}},{key:"trackPause",value:function(){var e=this.powa.getStatus().time,t=this.powa.getStatus().duration;!this.userPaused&&e&&0<e&&t&&t!=e&&(this.send("event136"),this.userPaused=!0)}},{key:"trackAdPause",value:function(){this.userPausedAd||(this.send("event140"),this.userPausedAd=!0)}},{key:"trackUnpause",value:function(){this.userPaused&&(this.send("event137"),this.userPaused=!1)}},{key:"trackAdUnpause",value:function(){this.userPausedAd&&(this.send("event141"),this.userPausedAd=!1)}},{key:"trackMute",value:function(e){e.muted?this.send("event128"):this.send("event73")}},{key:"trackAdMute",value:function(e){e.muted?this.send("event143",{adMeta:e.adMeta}):this.send("event144",{adMeta:e.adMeta})}},{key:"trackAutoplay",value:function(e){var t=this.powa.getDataset();"live-bar"!==t.playerType&&(!t.autoplay||this.userClickedToPlay||this.firedAutoplay||(this.firedAutoplay=!0,this.send("event75")),"preview2-autoplay"!==e.type||this.firedAutoplay||(this.firedAutoplay=!0,this.send("event75")))}},{key:"initListeners",value:function(){if(!this.listenersDone){this.listenersDone=!0;var e=this.powa.getDataset();1==e.prerollOnly?this.prerollPluginListeners():(this.powaListeners(),"inline-player-playlist"===e.playerType&&this.inlinePlayerPlaylistListeners())}}},{key:"prerollPluginListeners",value:function(){var t=this;this.powa.on("adStart",function(e){return t.sendAdEvent("event7",{adMeta:e.adMeta})}),this.powa.on("adComplete",function(e){return t.sendAdEvent("event8",{adMeta:e.adMeta})}),this.powa.on("adSkip",function(e){return t.send("event34",{adMeta:e.adMeta})})}},{key:"powaListeners",value:function(){var a=this,e=this.powa,t=this.powa.getDataset(),n=this;if(new fn({powa:e,va:n}),new Ln({powa:e,va:n}),this.powa.on("promoPlay",function(e){a.userClickedToPlay=!0,a.send("event125")}),this.powa.on("fullscreen",this.trackFullscreen.bind(this)),this.powa.on("nextClick",function(e){return a.nextClick=!0}),this.powa.on("prevClick",function(e){return a.prevClick=!0}),this.powa.on("pipActivated",function(e){return a.send("event172")}),this.powa.on("pipDeactivated",function(e){return a.send("event173")}),this.powa.on("adStart",function(e){return a.sendAdEvent("event7",{adMeta:e.adMeta})}),this.powa.on("adImpression",function(e){return a.sendAdEvent("event7_1",{adMeta:e.adMeta})}),this.powa.on("adComplete",function(e){return a.sendAdEvent("event8",{adMeta:e.adMeta})}),this.powa.on("adSkip",function(e){return a.send("event34",{adMeta:e.adMeta})}),this.powa.on("adEnd",function(e){return a.adEndVisibilityState=document.visibilityState}),this.powa.on("complete",this.initTimeIntervals.bind(this)),this.powa.on("muted",this.trackMute.bind(this)),this.powa.on("pause",this.trackPause.bind(this)),this.powa.on("play",this.trackUnpause.bind(this)),this.powa.on("adPause",this.trackAdPause.bind(this)),this.powa.on("adPlay",this.trackAdUnpause.bind(this)),this.powa.on("adMute",this.trackAdMute.bind(this)),this.powa.on("shareFacebook",function(e){return a.send("event6")}),this.powa.on("shareTwitter",function(e){return a.send("event6")}),this.powa.on("shareEmail",function(e){return a.send("event6")}),this.powa.on("upNextDismissed",function(e){return a.send("event168")}),this.powa.on("start",function(e){a.scanPowa(),a.initFlags.bind(a),a.trackAutoplay.call(a,e),a.playCounter=!0===a.firstPlay?0:a.playCounter+1,a.firstPlay=!1,a.setTimeMarker("playerStart")}),this.powa.on("preview2-autoplay",function(e){a.trackAutoplay.call(a,e)}),this.powa.on("loaded",function(){a.scanPowa()}),this.powa.on("playlistLoaded",function(e){a.scanPerformance()}),"live"===this.powa.getVideoData().video_type)this.powa.on("time",this.trackLiveTime);else if(t.mediaTailor){var o=!1;this.powa.on("time",function(e){if(1<e.time&&!o){o=!0;var t=(new Date).getTime(),n=Math.round(1e3*e.time),i=Math.round(t-n);a.send("event9",{time:i})}}),this.powa.on("start",function(){return o=!1}),this.powa.on("playback25",function(e){return a.send("event10")}),this.powa.on("playback50",function(e){return a.send("event11")}),this.powa.on("playback75",function(e){return a.send("event12")}),this.powa.on("playback100",function(e){return a.send("event13")})}else t.contintuousPlay||t.loop?(this.powa.once("firstFrame",function(e){return a.send("event9")}),this.powa.once("playback25",function(e){return a.send("event10")}),this.powa.once("playback50",function(e){return a.send("event11")}),this.powa.once("playback75",function(e){return a.send("event12")}),this.powa.once("playback100",function(e){return a.send("event13")})):(this.powa.on("firstFrame",function(e){return a.send("event9")}),this.powa.on("playback25",function(e){return a.send("event10")}),this.powa.on("playback50",function(e){return a.send("event11")}),this.powa.on("playback75",function(e){return a.send("event12")}),this.powa.on("playback100",function(e){return a.send("event13")}));new Bn({powa:e,va:n}),new gn({powa:e,va:n}),new _n({powa:e,va:n}),new Dn({powa:e,va:n}),new On({powa:e,va:n}),new jn({powa:e,va:n}),new Pn({powa:e,va:n}),this.powa.on("apsFetched",function(e){return a.send("event9996_4",pt(e,["timeSinceBidRequest","bidReturned"]))}),this.powa.on("apsTimeout",function(e){return a.send("event9996_3",pt(e,["timeSinceBidRequest"]))}),this.powa.on("stickyEngage",function(e){return a.send("sticky-engage")})}},{key:"inlinePlayerPlaylistListeners",value:function(){var t=this;window.wp_pb.register("video","pagePlaylistItemClicked",function(e){t.scanPowa(),t.userClickedToPlay=!0,t.send("event125")})}},{key:"powaVersionCheck",value:function(){var e=Ce(window,"PoWa.VERSION",""),t=parseInt(e.split(".")[0]);(!t||t<3)&&console.warn("VA Minimum of PoWa3 required")}}]),n}(),Un={};window.VideoAnalytics=window.VideoAnalytics||{version:"1.7.23",build:"da5d617",init:function(e,t){var n=1<arguments.length&&void 0!==t?t:{};return Un[e]?n.powaId&&Un[e].registerPoWa(n.powaId):Un[e]=new xn(e,n),Un[e]},static:{sendToNewRelic:$t.send,sendToOmniture:qt.send,sendToMpulse:Jt.send,sendToGoogle:dn.send,sendToSplunk:un.send}}}();
